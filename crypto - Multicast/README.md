# [crypto - Multicast](https://hack.cert.pl/challenge/multicast)

I noticed the flag was encrypted two times using different `e` and the same primes `p` and `q`, so I created a Python script that implements RSA common modulus attack:
```python
from math import gcd
from egcd import egcd
import sys

sys.setrecursionlimit(1500)

e1 = 3375916529
e2 = 3521159231
c1 = 2895305578222323514588725221327900949800432590898182720302944928687795377688805971049107422524654215031524827380412029543173808613759041478088941336944847766993313136026233764420536284020267388356424114190366971193994064312450756494700916890244514255182462804669195297351329274627167158384054722164938500234947608749249926237004648896323916635239656543386316559465865312064574265688129394721280197201965001999314135021170745745372776180554827680848657247060618395904931243933498158477336609764834075666266561381855602615559771106146051455115971887916929280829380979153561375676997809059914498636496328944968240739560
c2 = 8535497403164719833364051225037827569652546026464182142979201867386158448985979348519092403988903164888837438247629799569099904655569755896280514197440578858279317706006329581626358704923427242024185229340702331956871656994525373446161696945617583524206531289200612314014976231330943634777031969641271604363813415603215608492273954009114555920880597889562472040537757479048648211578313385353479672365399361427952079286746562797827991966958447443201603834738916121860181512169364033938014432841586821097448481833275226273251681275873667027961493915320564816339968979445432406617378641766445759692544091653959780498940
n = 11181700411402588469242030465213417619219489974714170225169881671766936221089951253656828045810708512278981577111949252480785131936982896656912826782207250853659791373212365459151469404913050921273800549131846228200107428791412695424457918689094269299222570164229204285779219136190864467561194346820185748990266184324136700897794760759263208389632677644128813428029011737825196898557131306993875782748467265091861986860728865467061927041053673285717879076154431549042425752830814208792104381433541650673667388016413313927759551548983904620541817263937224453806038007674783957747421291069233374713775384931199322591941

_, x, _ = egcd(e1, e2)
s1 = x % e2
s2 = int((gcd(e1, e2) - e1 * s1) / e2)
_, x, _ = egcd(c2, n)
t = x % n
m1 = pow(c1, s1, n)
m2 = pow(t, -s2, n)
m = (m1 * m2) % n
decoded = bytearray.fromhex('{:0192x}'.format(m)).decode('utf-8', 'ignore')
print(decoded)
```
In output we can see the flag:
```
.!Lncecsc23{every_ctf_needs_some_rsa_breaking_challenge}GC	ĵ6|~]4DlxMZ_
4+XGtߚ'"N|^/bS_yhr_
```

### Flag
```
ecsc23{every_ctf_needs_some_rsa_breaking_challenge}
```
